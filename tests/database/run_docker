#!/bin/bash

SCRIPTS_BASE=/usr/local/Cellar/sysbench/1.0.20/share/sysbench
MYSQL_USER=root
MYSQL_PASSWORD=root
MYSQL_DATABASE=sbtest
MYSQL_PORT=3306
MYSQL_HOST=127.0.0.1

# docker run -d --rm \
#     --name mysql \
#     -p $MYSQL_PORT:3306 \
#     -e MYSQL_ROOT_PASSWORD=$MYSQL_USER \
#     -e MYSQL_DATABASE=$MYSQL_DATABASE \
#     mysql:8

# sysbench $SCRIPTS_BASE/oltp_read_only.lua \
#     --threads=4 \
#     --mysql-user=$MYSQL_USER \
#     --mysql-password=$MYSQL_PASSWORD \
#     --mysql-port=$MYSQL_PORT \
#     --mysql-host=$MYSQL_HOST \
#     --mysql-db=$MYSQL_DATABASE \
#     --tables=10 \
#     --table-size=1000000 \
#     prepare

sysbench $SCRIPTS_BASE/oltp_read_only.lua \
    --threads=16 \
    --events=0 \
    --time=300 \
    --mysql-user=$MYSQL_USER \
    --mysql-password=$MYSQL_PASSWORD \
    --mysql-port=$MYSQL_PORT \
    --mysql-host=$MYSQL_HOST \
    --mysql-db=$MYSQL_DATABASE \
    --tables=10 \
    --table-size=1000000 \
    --range_selects=off \
    --db-ps-mode=disable \
    --report-interval=1 \
    run
